apiVersion: 1

contactPoints:
  - orgId: 1
    name: default-contact-point
    receivers:
      - uid: default-receiver
        type: email
        settings:
          addresses: admin@example.com
        disableResolveMessage: false

  - orgId: 1
    name: security-team
    receivers:
      - uid: security-email
        type: email
        settings:
          addresses: security@example.com
        disableResolveMessage: false
      - uid: security-slack
        type: slack
        settings:
          url: https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
          recipient: '#security-alerts'
          username: Grafana Security Bot
          icon_emoji: ':rotating_light:'
          title: 'Security Alert: {{ .CommonLabels.alertname }}'
          text: '{{ .CommonAnnotations.description }}'
        disableResolveMessage: false

policies:
  - orgId: 1
    receiver: default-contact-point
    group_by: ['alertname', 'severity']
    group_wait: 30s
    group_interval: 5m
    repeat_interval: 4h
    routes:
      - receiver: security-team
        matchers:
          - category = security
        group_wait: 10s
        group_interval: 1m
        repeat_interval: 30m
        continue: false
      
      - receiver: default-contact-point
        matchers:
          - severity =~ "warning|critical"
        group_wait: 30s
        group_interval: 5m
        repeat_interval: 2h
        continue: true
