# Gitleaks configuration for local secret scanning
# Run: gitleaks detect --config .gitleaks.toml

title = "E-commerce A/B Test Dashboard - Gitleaks Config"

[extend]
# useDefault will extend the base configuration with the default gitleaks config:
# https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml
useDefault = true

[allowlist]
description = "Allowlist for false positives"

# Paths to ignore
paths = [
    '''.*test.*\.py$''',               # Test files
    '''.*_test\.py$''',                # Test files pattern
    '''tests/.*''',                    # Test directories
    '''.*\.example$''',                # Example files
    '''\.env\.example$''',             # Example environment
    '''docs/.*\.md$''',                # Documentation
    '''.*docker-compose.*\.yml$''',    # Docker compose files
]

# Regex patterns to ignore (false positives)
regexes = [
    '''test_ci_password_not_production''',     # CI test password
    '''changeme''',                             # Placeholder
    '''your_password_here''',                   # Placeholder
    '''CHANGE_ME''',                            # Placeholder
    '''example_password''',                     # Example
    '''your_secret_key_here''',                 # Placeholder
]

# Specific commits to ignore (already remediated)
commits = [
    '''cfc1b8d''',  # test_auth.py and import_security_dashboard.py deleted
    '''3656fb6''',  # security_attack_suite.py deleted
]

# Stopwords - tokens that if found should not be considered a secret
stopwords = [
    '''postgres''',      # Common database name
    '''admin''',         # Common username
    '''test''',          # Test credential indicator
    '''example''',       # Example credential indicator
    '''changeme''',      # Placeholder
    '''placeholder''',   # Placeholder
]

[[rules]]
description = "Ignore test database credentials in CI workflows"
id = "test-db-credentials"
regex = '''postgresql://postgres:test_ci_password'''
path = '''\.github/workflows/.*\.yml$'''

[[rules]]
description = "Ignore development placeholders"
id = "dev-placeholders"
regex = '''(changeme|CHANGE_ME|your_password_here|example_password)'''
